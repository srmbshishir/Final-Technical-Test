@{
    ViewBag.Title = "Home Page";
}

<h2>Index</h2>

<div align="right">
    <button type="button" name="add" id="add" class="btn btn-success">create</button>
</div>
<table class="table table-bordered" id="my-table">
    <tr>
        <th width="35%">Name</th>
        <th width="25%">Price</th>
        <th width="10%">Action</th>
    </tr>

</table>

@section scripts{
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
    <script>
        $(document).ready(function () {

            var count = 0;
            $.ajax({
                type: "GET",
                url: '/Home/GetList',
                success: function (response) {
                    $.each(response, function (key, item) {
                        count += 1;
                        console.log(count);
                        var html_code = "<tr id='row" + count + "'>";
                        html_code += "<td class='name'>" + item.name + "</td>";
                        html_code += "<td class='price'>" + item.price + "</td>";
                        html_code += "<td><button type='button' id='edit" + count + "' name='edit' data-row='row" + count + "' class='btn btn-primary edit'>Edit</button></td>";
                        html_code += "<td><button type='button' style='display:none;' id='update" + count + "' name='update' data-row='row" + count + "' class='btn btn-primary update'>Update</button></td>";
                        html_code += "<td><button type='button' style='display:none;' id='cancel" + count + "' name='cancel' data-row='row" + count + "' class='btn btn-danger cancel'>Cancel</button></td>";
                        html_code += "</tr>";

                        $('#my-table').append(html_code);
                    });
                
                }
            })
           
            $('#add').click(function () {
                console.log("hello");
                count += 1;
                var html_code = "<tr id='row" + count + "'>";
                html_code += "<td contenteditable='true' class='name'></td>";
                html_code += "<td contenteditable='true' class='price'></td>";
                html_code += "<td><button type='button' name='remove' data-row='row" + count + "' class='btn btn-danger remove'>Delete</button></td>";
                html_code += "</tr>";

                $('#my-table').append(html_code);
            });
            $(document).on('click', '.remove', function () {
                console.log("hello");
                var delete_row = $(this).data("row");
                $('#' + delete_row).remove();
            });
            $(document).on('click', '.edit', function () {
                console.log("hello");
                var edit_row = $(this).data("row");
                $('#' + edit_row).attr('contenteditable', 'true');
                $('#' + this.id).hide();
                var number = $(this).closest('.edit').attr('id').split('t')[1];
                $('#cancel' + number).show();
                $('#update' + number).show();
            });
            $(document).on('click', '.cancel', function () {
                console.log("cancel");
                var cancel_row = $(this).data("row");
                $('#' + cancel_row).attr('contenteditable', 'false');
                $('#' + this.id).hide();
                var number1 = $(this).closest('.cancel').attr('id').split('t')[1];
                console.log(number1);
                $('#update' + number1).hide();
                $('#edit' + number1).show();
            });
        });
    </script>
}